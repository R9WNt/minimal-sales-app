:root {
  --base: 8px;
}

/* Responsive, clamp-driven variables. Tweak these if you want different breakpoints/scale. */
.container {
  /* primary scale variables (clamped) */
  --gap: clamp(2px, 0.6vw, 8px);
  --cube: clamp(14px, 2.2vw, 22px);           /* visual cube size */
  --hit: 44px;                                /* intended hit area (JS will enforce >= 44) */
  --circle: clamp(160px, calc(var(--cube) * 10), 320px);
  --desc: clamp(140px, calc(var(--circle) * 0.75), 260px);
  --desc-coverage-threshold: 0.80; /* fraction of preferred width to require inline */
  /* Tuning for tighter inline mode and nudging behavior */
  --desc-nudge-threshold: 6px; /* px short required to perform a nudge */
  --desc-nudge-multiplier: 1.2; /* multiplier applied to shortfall when computing nudge */
  --desc-max-nudge: 48px; /* cap for nudge in px */
  --desc-min: 120px; /* absolute minimum desc width used as a fallback */

  position: fixed;
  bottom: auto;
  right: auto;
  margin: 0 auto;
  width: fit-content;
  min-height: var(--circle);
  z-index: 9999;
  touch-action: none;
  pointer-events: auto;
  box-sizing: border-box;
}

/* inner widget area that is the drag target (except interactive children) */
.widget {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  gap: var(--gap);
  padding: clamp(4px, 1vw, 12px);
  box-sizing: border-box;
  -webkit-tap-highlight-color: transparent;
}

/* the circular area that hosts cubes */
.circle {
  width: var(--circle);
  height: var(--circle);
  position: relative;
  flex: 0 0 auto;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* decorative circle background */
.circleBg {
  position: absolute;
  width: 100%;
  height: 100%;
  border-radius: 50%;
  background: rgba(255,255,255,0.04);
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
  pointer-events: none;
}

/* cube button: hit area is var(--hit), with padding so the visual cube remains var(--cube) */
/* we use padding calculation so visual cube stays small while hit area remains >= 44px */
.cubeBtn {
  position: absolute;
  transform: translate(-50%, -50%);
  width: var(--hit);
  height: var(--hit);
  padding: calc((var(--hit) - var(--cube)) / 2);
  border: none;
  background: transparent;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  min-width: 44px;
  min-height: 44px;
}

/* inner wrapper for the visual cube (exact visual size var(--cube)) */
.cubeInner {
  width: var(--cube);
  height: var(--cube);
  display: flex;
  align-items: center;
  justify-content: center;
  pointer-events: none; /* visual is decorative, interactions handled by button */
  min-width: 12px;
  min-height: 12px;
}

/* focus styles for keyboard users */
.cubeBtn:focus {
  outline: none;
  box-shadow: none;
}

/* invisible center X: functional but not visible; keeps hit events */
.centerBtn {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: 40px;
  height: 40px;
  border-radius: 999px;
  background: transparent;
  border: none;
  cursor: pointer;
  opacity: 0; /* invisible */
  pointer-events: auto;
}

/* Show a visible focus indication if the center button is focused (e.g. by
   programmatic focus). We keep it visually hidden by default, but keyboard
   users should still get visible feedback when the control receives focus. */
.centerBtn:focus {
  opacity: 0;
  outline: none;
  box-shadow: none;
}

/* description panel: uses var(--desc) for width; visibility toggled from JS/inline styles,
   but keep transitions for smoothness */
.desc {
  width: var(--desc);
  min-height: var(--circle);
  background: white;
  border-radius: 8px;
  box-shadow: 0 6px 18px rgba(12,20,30,0.08);
  padding: clamp(6px, 1.2vw, 12px);
  box-sizing: border-box;
  flex: 0 0 auto;
  display: flex;
  flex-direction: column;
  justify-content: center;
  position: relative;
  transition: opacity 120ms ease;
  margin-left: 0; /* rely on flex gap for spacing */
}



/* inset frame to create double-rect look */
.desc::after {
  content: "";
  position: absolute;
  inset: 6px;
  border: 1px solid rgba(12,20,30,0.04);
  border-radius: 6px;
  pointer-events: none;
}

/* header strip inside the panel */
.descHeader {
  width: 100%;
  height: 14px;
  background: linear-gradient(90deg, rgba(245,245,245,0.8), rgba(250,250,250,0.6));
  border-radius: 4px;
  display: flex;
  align-items: center;
  padding: 0 6px;
  margin-bottom: 6px;
  box-sizing: border-box;
}

/* When description should render to the left of the ring */
.descLeft {
  order: -1; /* move before the circle */
  margin-right: calc(var(--gap) + 6px);
  margin-left: 0;
}




/* close button inside description */
.descClose {
  position: absolute;
  right: 8px;
  top: 8px;
  width: 26px;
  height: 26px;
  border-radius: 6px;
  background: transparent;
  border: none;
  color: #475569;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.descClose:focus,
.overlayClose:focus {
  outline: none;
  box-shadow: none;
}

/* prefers-reduced-motion respect */
@media (prefers-reduced-motion: reduce) {
  .desc {
    transition: none;
  }
  .cubeBtn,
  .centerBtn {
    transition: none;
  }
}

/* small responsive tweak: on very narrow screens, we'll keep vars but you may prefer to collapse description overlay */
@media (max-width: 420px) {
  /* small-screen tweaks can be set here if desired */
  .container {
    /* increase min circle so it doesn't scale down too far on small screens */
    --circle: clamp(180px, 36vw, 220px);
    /* give the description more room in overlay contexts */
    --desc: clamp(220px, 80vw, 320px);
    --gap: clamp(4px, 2vw, 8px);
  }

  /* make overlay panel take more of the viewport on small screens */
  .overlayPanel {
    max-width: 96%;
    padding: 12px;
  }
}

/* Add to src/components/ui/FAQWidget.module.css (append) */

/* Overlay backdrop used by src/components/ui/Overlay.tsx */
.overlayBackdrop {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,0.40); /* semi-opaque backdrop */
  -webkit-tap-highlight-color: transparent;
  z-index: var(--z-backdrop); /* use token if available, fallback number */
  pointer-events: auto;
}

/* Panel inside the overlay (focus container). Keep it responsive. */
.overlayPanel {
  position: relative;
  z-index: var(--z-modal);
  background: transparent; /* inner content controls its own background */
  max-width: 92%;
  max-height: 92%;
  overflow: auto;
  box-sizing: border-box;
  padding: 16px;
  margin: 12px;
  border-radius: 10px;
  display: block;
  pointer-events: auto;
}

/* Desktop variant for overlay rendering (used when forcing overlay on large screens) */
.overlayPanelDesktop {
  max-width: 70%;
  padding: 12px;
  margin: 10px;
  border-radius: 8px;
}

/* Close button used in the overlay content for small screen description */
.overlayClose {
  position: absolute;
  top: 10px;
  right: 10px;
  width: 36px;
  height: 36px;
  border-radius: 8px;
  background: rgba(255,255,255,0.98);
  border: none;
  font-size: 18px;
  line-height: 1;
  cursor: pointer;
  color: #0f172a;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  z-index: var(--z-top);
}